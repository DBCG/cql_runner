<nav id="header" class="mx-auto flex">
  <div class="mx-auto self-center flex-auto title">CQL Runner</div>
  <button (click)="toggleResources()" class="self-center button flex">
    <div class="self-center" style="margin-right: 5px;">
      CQL Language Resources
    </div>
    <i class="material-icons">help</i>
  </button>
</nav>
<div class="resources" [hidden]="!resources">
  <ul>
    <li><a href="https://cqlengine.readthedocs.io/en/latest/" target="_blank">CQL Engine Documentation Home</a></li>
  </ul>
</div>
<form #f="ngForm" id="form-wrapper">
  <div class="md-flex editors">
    <div id="input-section" class="md-col-6">
      <div class="row flex">
        <h4 class="title self-center md-col-1">Input</h4>
        <div id="select-engine" class="md-col-5 self-center">
          <div class="title">Engine Service URL</div>
          <div class="link" [hidden]="editingEngineUri" (click)="toggleEditingEngineUri()">{{ model.engineServiceUri }} <i class="material-icons" style="font-size: 0.75em">mode_edit</i></div>
          <div [hidden]="!editingEngineUri">
            <input type="text"
              class="input"
              [(ngModel)]="model.engineServiceUri"
              name="engineServiceUri">
          </div>
          </div>
        <div id="select-fhir" class="md-col-5 self-center">
          <div class="title">Terminology Service URL</div>
          <div class="link" [hidden]="editingFhirUri" (click)="toggleEditingFhirUri()">{{ model.fhirServiceUri }} <i class="material-icons" style="font-size: 0.75em">mode_edit</i></div>
          <div [hidden]="!editingFhirUri">
            <input type="text"
              class="input"
              [(ngModel)]="model.fhirServiceUri"
              name="fhirServiceUri">
          </div>
        </div>
        <div id="select-data" class="md-col-5 self-center">
          <div class="title">FHIR Service URL</div>
          <div class="link" [hidden]="editingDataUri" (click)="toggleEditingDataUri()">{{ model.dataServiceUri }} <i class="material-icons" style="font-size: 0.75em">mode_edit</i></div>
          <div [hidden]="!editingDataUri">
            <input type="text"
              class="input"
              [(ngModel)]="model.dataServiceUri"
              name="dataServiceUri">
          </div>
        </div>
        <div id="select-patient" class="md-col-5 self-center">
          <div class="title">Patient ID</div>
          <div class="link" [hidden]="editingPatientId" (click)="toggleEditingPatientId()">{{ model.patientId }} <i class="material-icons" style="font-size: 0.75em">mode_edit</i></div>
          <div [hidden]="!editingPatientId" (clickOutside)="toggleEditingPatientId()">
            <input type="text"
              class="input"
              [(ngModel)]="model.patientId"
              name="patientId">
          </div>
        </div>
        <button class="button flex md-col-2" [class.running]="running" (click)="runScript()">
          <div class="self-center">
            {{ running ? 'Running...' : 'Run'}}
          </div>
          <i class="material-icons" [hidden]="running">play_arrow</i>
        </button>
      </div>
      <div class="input-window" ace-editor [text]="iText" [mode]="'cql'" [options]="iOptions" [theme]="iTheme" [autoUpdateContent]="true" (textChanged)="onInputChange($event)"></div>
    </div>
    <div id="output-section" class="md-col-6">
      <div class="row flex">
        <h4 class="title flex-auto self-center">Output</h4>
        <button class="button flex" (click)="clearOutput()">
          <div class="self-center">
            Clear
          </div>
          <i class="material-icons" [hidden]="running">clear_all</i>
        </button>
      </div>
      <div class="output-window" ace-editor [text]="oText" [mode]="'cql'" [options]="oOptions" [readOnly]="oIsReadOnly" [autoUpdateContent]="true"></div>
    </div>

  </div>
</form>


<div id="introduction">
  <h1>CQL Runner</h1>

  <p>The CQL runner was designed to provide a live testbed for your CQL expressions.</p>

  <p>The CQL service URL may be configured to point to your own CQL engine (our CQL engine endpoint is used by default)</p>

  <p>This is an open-source projectâ€“feel free to <a href="https://github.com/DBCG/cql_runner">contribute and leave feedback</a>.</p>

  <p>The execution service end is a <a href="https://github.com/DBCG/cql_execution_service">separate project</a></p>

</div>
